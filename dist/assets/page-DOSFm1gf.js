import{c as V,j as t,B as z,r as S,A as Ne,h as Ee,u as Ce,d as Ie,e as ke,D as de,s as Re,__tla as __tla_0}from"./index-DFsdLsM1.js";import{u as Pe,__tla as __tla_1}from"./useGameContract-68INYc6U.js";import{m as E,__tla as __tla_2}from"./proxy-A_CkDGxd.js";let Je;let __tla=Promise.all([(()=>{try{return __tla_0}catch{}})(),(()=>{try{return __tla_1}catch{}})(),(()=>{try{return __tla_2}catch{}})()]).then(async()=>{const Te=V("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);const Se=V("Frown",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M16 16s-1.5-2-4-2-4 2-4 2",key:"epbg0q"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);const Oe=V("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);const Le=V("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);const Ae=V("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);const Fe=V("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),ue={0:[1,2,4],1:[0,4],2:[0,3,4],3:[2,4],4:[0,1,2,3]},Ge=[{x:20,y:80},{x:20,y:20},{x:80,y:80},{x:80,y:20},{x:50,y:50}];function Be({player:c,selected:l=!1,onClick:f}){return c?t.jsx("div",{className:`
        w-8 h-8 
        cursor-pointer 
        transition-all
        ${l?"scale-110 ring-2 ring-white animate-pulse":""}
        ${c==="GREEN"?"text-green-500":"text-orange-500"}
      `,onClick:f,children:t.jsxs("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"w-full h-full",children:[t.jsx("path",{d:"M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"}),t.jsx("circle",{cx:"8",cy:"10",r:"1",fill:"white"}),t.jsx("circle",{cx:"16",cy:"10",r:"1",fill:"white"}),t.jsx("path",{d:"M12 14.5C10.5 14.5 9.5 13.5 9.5 13.5C9.5 13.5 10.5 14.5 12 14.5C13.5 14.5 14.5 13.5 14.5 13.5C14.5 13.5 13.5 14.5 12 14.5Z",fill:"white"})]})}):t.jsx("div",{className:"w-8 h-8 rounded-full bg-white/20 cursor-pointer",onClick:f})}function _e({board:c=[],currentPlayer:l,selectedPiece:f,onMove:m,onSelect:b}){const M=R=>{if(console.log(R,f,c,l),f===null){if(c[R]===l){const P=ue[R]||[];console.log(P),P.some(D=>!c[D])&&b(R)}}else(ue[f]||[]).includes(R)&&!c[R]?m(f,R):b(null)};return t.jsxs("div",{className:"relative w-[300px] h-[300px] bg-sky-100 rounded-lg",children:[t.jsxs("svg",{className:"absolute inset-0 w-full h-full",viewBox:"0 0 100 100",strokeWidth:"1",stroke:"white",fill:"none",children:[t.jsx("path",{d:"M20,20 L20,80 L80,80 L80,20"}),t.jsx("line",{x1:"20",y1:"20",x2:"80",y2:"80"}),t.jsx("line",{x1:"20",y1:"80",x2:"80",y2:"20"})]}),Ge.map((R,P)=>t.jsx("div",{className:"absolute transform -translate-x-1/2 -translate-y-1/2",style:{left:`${R.x}%`,top:`${R.y}%`},children:t.jsx(Be,{player:c[P],selected:f===P,onClick:()=>M(P)})},P))]})}var re={};(function c(l,f,m,b){var M=!!(l.Worker&&l.Blob&&l.Promise&&l.OffscreenCanvas&&l.OffscreenCanvasRenderingContext2D&&l.HTMLCanvasElement&&l.HTMLCanvasElement.prototype.transferControlToOffscreen&&l.URL&&l.URL.createObjectURL),R=typeof Path2D=="function"&&typeof DOMMatrix=="function",P=function(){if(!l.OffscreenCanvas)return!1;var a=new OffscreenCanvas(1,1),e=a.getContext("2d");e.fillRect(0,0,1,1);var r=a.transferToImageBitmap();try{e.createPattern(r,"no-repeat")}catch{return!1}return!0}();function D(){}function G(a){var e=f.exports.Promise,r=e!==void 0?e:l.Promise;return typeof r=="function"?new r(a):(a(D,D),null)}var U=function(a,e){return{transform:function(r){if(a)return r;if(e.has(r))return e.get(r);var s=new OffscreenCanvas(r.width,r.height),i=s.getContext("2d");return i.drawImage(r,0,0),e.set(r,s),s},clear:function(){e.clear()}}}(P,new Map),B=function(){var a=Math.floor(16.666666666666668),e,r,s={},i=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(e=function(o){var d=Math.random();return s[d]=requestAnimationFrame(function n(u){i===u||i+a-1<u?(i=u,delete s[d],o()):s[d]=requestAnimationFrame(n)}),d},r=function(o){s[o]&&cancelAnimationFrame(s[o])}):(e=function(o){return setTimeout(o,a)},r=function(o){return clearTimeout(o)}),{frame:e,cancel:r}}(),Y=function(){var a,e,r={};function s(i){function o(d,n){i.postMessage({options:d||{},callback:n})}i.init=function(n){var u=n.transferControlToOffscreen();i.postMessage({canvas:u},[u])},i.fire=function(n,u,v){if(e)return o(n,null),e;var w=Math.random().toString(36).slice(2);return e=G(function(g){function j(k){k.data.callback===w&&(delete r[w],i.removeEventListener("message",j),e=null,U.clear(),v(),g())}i.addEventListener("message",j),o(n,w),r[w]=j.bind(null,{data:{callback:w}})}),e},i.reset=function(){i.postMessage({reset:!0});for(var n in r)r[n](),delete r[n]}}return function(){if(a)return a;if(!m&&M){var i=["var CONFETTI, SIZE = {}, module = {};","("+c.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{a=new Worker(URL.createObjectURL(new Blob([i])))}catch(o){return typeof console!==void 0&&typeof console.warn=="function"&&console.warn("\uD83C\uDF8A Could not load worker",o),null}s(a)}return a}}(),H={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function J(a,e){return e?e(a):a}function Q(a){return a!=null}function p(a,e,r){return J(a&&Q(a[e])?a[e]:H[e],r)}function X(a){return a<0?0:Math.floor(a)}function Z(a,e){return Math.floor(Math.random()*(e-a))+a}function $(a){return parseInt(a,16)}function x(a){return a.map(y)}function y(a){var e=String(a).replace(/[^0-9a-f]/gi,"");return e.length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),{r:$(e.substring(0,2)),g:$(e.substring(2,4)),b:$(e.substring(4,6))}}function N(a){var e=p(a,"origin",Object);return e.x=p(e,"x",Number),e.y=p(e,"y",Number),e}function C(a){a.width=document.documentElement.clientWidth,a.height=document.documentElement.clientHeight}function _(a){var e=a.getBoundingClientRect();a.width=e.width,a.height=e.height}function K(a){var e=document.createElement("canvas");return e.style.position="fixed",e.style.top="0px",e.style.left="0px",e.style.pointerEvents="none",e.style.zIndex=a,e}function I(a,e,r,s,i,o,d,n,u){a.save(),a.translate(e,r),a.rotate(o),a.scale(s,i),a.arc(0,0,1,d,n,u),a.restore()}function q(a){var e=a.angle*(Math.PI/180),r=a.spread*(Math.PI/180);return{x:a.x,y:a.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:a.startVelocity*.5+Math.random()*a.startVelocity,angle2D:-e+(.5*r-Math.random()*r),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:a.color,shape:a.shape,tick:0,totalTicks:a.ticks,decay:a.decay,drift:a.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:a.gravity*3,ovalScalar:.6,scalar:a.scalar,flat:a.flat}}function ee(a,e){e.x+=Math.cos(e.angle2D)*e.velocity+e.drift,e.y+=Math.sin(e.angle2D)*e.velocity+e.gravity,e.velocity*=e.decay,e.flat?(e.wobble=0,e.wobbleX=e.x+10*e.scalar,e.wobbleY=e.y+10*e.scalar,e.tiltSin=0,e.tiltCos=0,e.random=1):(e.wobble+=e.wobbleSpeed,e.wobbleX=e.x+10*e.scalar*Math.cos(e.wobble),e.wobbleY=e.y+10*e.scalar*Math.sin(e.wobble),e.tiltAngle+=.1,e.tiltSin=Math.sin(e.tiltAngle),e.tiltCos=Math.cos(e.tiltAngle),e.random=Math.random()+2);var r=e.tick++/e.totalTicks,s=e.x+e.random*e.tiltCos,i=e.y+e.random*e.tiltSin,o=e.wobbleX+e.random*e.tiltCos,d=e.wobbleY+e.random*e.tiltSin;if(a.fillStyle="rgba("+e.color.r+", "+e.color.g+", "+e.color.b+", "+(1-r)+")",a.beginPath(),R&&e.shape.type==="path"&&typeof e.shape.path=="string"&&Array.isArray(e.shape.matrix))a.fill(me(e.shape.path,e.shape.matrix,e.x,e.y,Math.abs(o-s)*.1,Math.abs(d-i)*.1,Math.PI/10*e.wobble));else if(e.shape.type==="bitmap"){var n=Math.PI/10*e.wobble,u=Math.abs(o-s)*.1,v=Math.abs(d-i)*.1,w=e.shape.bitmap.width*e.scalar,g=e.shape.bitmap.height*e.scalar,j=new DOMMatrix([Math.cos(n)*u,Math.sin(n)*u,-Math.sin(n)*v,Math.cos(n)*v,e.x,e.y]);j.multiplySelf(new DOMMatrix(e.shape.matrix));var k=a.createPattern(U.transform(e.shape.bitmap),"no-repeat");k.setTransform(j),a.globalAlpha=1-r,a.fillStyle=k,a.fillRect(e.x-w/2,e.y-g/2,w,g),a.globalAlpha=1}else if(e.shape==="circle")a.ellipse?a.ellipse(e.x,e.y,Math.abs(o-s)*e.ovalScalar,Math.abs(d-i)*e.ovalScalar,Math.PI/10*e.wobble,0,2*Math.PI):I(a,e.x,e.y,Math.abs(o-s)*e.ovalScalar,Math.abs(d-i)*e.ovalScalar,Math.PI/10*e.wobble,0,2*Math.PI);else if(e.shape==="star")for(var h=Math.PI/2*3,T=4*e.scalar,O=8*e.scalar,L=e.x,F=e.y,W=5,A=Math.PI/W;W--;)L=e.x+Math.cos(h)*O,F=e.y+Math.sin(h)*O,a.lineTo(L,F),h+=A,L=e.x+Math.cos(h)*T,F=e.y+Math.sin(h)*T,a.lineTo(L,F),h+=A;else a.moveTo(Math.floor(e.x),Math.floor(e.y)),a.lineTo(Math.floor(e.wobbleX),Math.floor(i)),a.lineTo(Math.floor(o),Math.floor(d)),a.lineTo(Math.floor(s),Math.floor(e.wobbleY));return a.closePath(),a.fill(),e.tick<e.totalTicks}function he(a,e,r,s,i){var o=e.slice(),d=a.getContext("2d"),n,u,v=G(function(w){function g(){n=u=null,d.clearRect(0,0,s.width,s.height),U.clear(),i(),w()}function j(){m&&!(s.width===b.width&&s.height===b.height)&&(s.width=a.width=b.width,s.height=a.height=b.height),!s.width&&!s.height&&(r(a),s.width=a.width,s.height=a.height),d.clearRect(0,0,s.width,s.height),o=o.filter(function(k){return ee(d,k)}),o.length?n=B.frame(j):g()}n=B.frame(j),u=g});return{addFettis:function(w){return o=o.concat(w),v},canvas:a,promise:v,reset:function(){n&&B.cancel(n),u&&u()}}}function ne(a,e){var r=!a,s=!!p(e||{},"resize"),i=!1,o=p(e,"disableForReducedMotion",Boolean),d=M&&!!p(e||{},"useWorker"),n=d?Y():null,u=r?C:_,v=a&&n?!!a.__confetti_initialized:!1,w=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,g;function j(h,T,O){for(var L=p(h,"particleCount",X),F=p(h,"angle",Number),W=p(h,"spread",Number),A=p(h,"startVelocity",Number),ye=p(h,"decay",Number),ve=p(h,"gravity",Number),ge=p(h,"drift",Number),le=p(h,"colors",x),pe=p(h,"ticks",Number),ie=p(h,"shapes"),be=p(h,"scalar"),we=!!p(h,"flat"),oe=N(h),ce=L,te=[],je=a.width*oe.x,Me=a.height*oe.y;ce--;)te.push(q({x:je,y:Me,angle:F,spread:W,startVelocity:A,color:le[ce%le.length],shape:ie[Z(0,ie.length)],ticks:pe,decay:ye,gravity:ve,drift:ge,scalar:be,flat:we}));return g?g.addFettis(te):(g=he(a,te,u,T,O),g.promise)}function k(h){var T=o||p(h,"disableForReducedMotion",Boolean),O=p(h,"zIndex",Number);if(T&&w)return G(function(A){A()});r&&g?a=g.canvas:r&&!a&&(a=K(O),document.body.appendChild(a)),s&&!v&&u(a);var L={width:a.width,height:a.height};n&&!v&&n.init(a),v=!0,n&&(a.__confetti_initialized=!0);function F(){if(n){var A={getBoundingClientRect:function(){if(!r)return a.getBoundingClientRect()}};u(A),n.postMessage({resize:{width:A.width,height:A.height}});return}L.width=L.height=null}function W(){g=null,s&&(i=!1,l.removeEventListener("resize",F)),r&&a&&(document.body.contains(a)&&document.body.removeChild(a),a=null,v=!1)}return s&&!i&&(i=!0,l.addEventListener("resize",F,!1)),n?n.fire(h,L,W):j(h,L,W)}return k.reset=function(){n&&n.reset(),g&&g.reset()},k}var ae;function se(){return ae||(ae=ne(null,{useWorker:!0,resize:!0})),ae}function me(a,e,r,s,i,o,d){var n=new Path2D(a),u=new Path2D;u.addPath(n,new DOMMatrix(e));var v=new Path2D;return v.addPath(u,new DOMMatrix([Math.cos(d)*i,Math.sin(d)*i,-Math.sin(d)*o,Math.cos(d)*o,r,s])),v}function fe(a){if(!R)throw new Error("path confetti are not supported in this browser");var e,r;typeof a=="string"?e=a:(e=a.path,r=a.matrix);var s=new Path2D(e),i=document.createElement("canvas"),o=i.getContext("2d");if(!r){for(var d=1e3,n=d,u=d,v=0,w=0,g,j,k=0;k<d;k+=2)for(var h=0;h<d;h+=2)o.isPointInPath(s,k,h,"nonzero")&&(n=Math.min(n,k),u=Math.min(u,h),v=Math.max(v,k),w=Math.max(w,h));g=v-n,j=w-u;var T=10,O=Math.min(T/g,T/j);r=[O,0,0,O,-Math.round(g/2+n)*O,-Math.round(j/2+u)*O]}return{type:"path",path:e,matrix:r}}function xe(a){var e,r=1,s="#000000",i='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof a=="string"?e=a:(e=a.text,r="scalar"in a?a.scalar:r,i="fontFamily"in a?a.fontFamily:i,s="color"in a?a.color:s);var o=10*r,d=""+o+"px "+i,n=new OffscreenCanvas(o,o),u=n.getContext("2d");u.font=d;var v=u.measureText(e),w=Math.ceil(v.actualBoundingBoxRight+v.actualBoundingBoxLeft),g=Math.ceil(v.actualBoundingBoxAscent+v.actualBoundingBoxDescent),j=2,k=v.actualBoundingBoxLeft+j,h=v.actualBoundingBoxAscent+j;w+=j+j,g+=j+j,n=new OffscreenCanvas(w,g),u=n.getContext("2d"),u.font=d,u.fillStyle=s,u.fillText(e,k,h);var T=1/r;return{type:"bitmap",bitmap:n.transferToImageBitmap(),matrix:[T,0,0,T,-w*T/2,-g*T/2]}}f.exports=function(){return se().apply(this,arguments)},f.exports.reset=function(){se().reset()},f.exports.create=ne,f.exports.shapeFromPath=fe,f.exports.shapeFromText=xe})(function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}}(),re,!1);const De=re.exports;re.exports.create;function qe({inviterAddress:c,onAcceptInvitation:l,onDeclineInvitation:f}){const m=b=>`${b.slice(0,6)}...${b.slice(-4)}`;return t.jsx("div",{className:"flex flex-col items-center justify-center bg-gray-100",children:t.jsxs(E.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5},className:"bg-white rounded-lg shadow-lg p-8 max-w-md w-full space-y-6 text-center",children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Game Invitation Received! \uD83D\uDCE9"}),t.jsxs("p",{className:"text-lg text-gray-600",children:[t.jsx("span",{className:"font-semibold",children:m(c)})," has invited you to join a game."]}),t.jsx("div",{className:"flex justify-center",children:t.jsx(E.div,{animate:{y:[0,-10,0]},transition:{duration:1,repeat:1/0},className:"text-6xl",children:"\uD83C\uDFAE"})}),t.jsx("p",{className:"text-xl text-gray-700",children:"Do you want to accept the invitation?"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs(z,{onClick:l,className:"w-full bg-green-500 hover:bg-green-600",children:[t.jsx(Ae,{className:"mr-2 h-4 w-4"})," Accept Invitation ✅"]}),t.jsxs(z,{onClick:f,variant:"outline",className:"w-full border-red-500 text-red-500 hover:bg-red-50",children:[t.jsx(Fe,{className:"mr-2 h-4 w-4"})," Decline Invitation ❌"]})]})]})})}function We({isWinner:c,onReturnToLobby:l}){S.useEffect(()=>{c&&De({particleCount:100,spread:70,origin:{y:.6}})},[c]);const f=c?"\uD83C\uDFC6":"\uD83D\uDE22",m=c?"Congratulations! You Won!":"Game Over. Better luck next time!",b=c?"bg-green-100":"bg-red-100",M=c?"text-green-800":"text-red-800";return t.jsx("div",{className:"flex items-center justify-center bg-gray-100",children:t.jsxs(E.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5},className:`${b} ${M} rounded-lg shadow-lg p-8 max-w-md w-full space-y-6 text-center`,children:[t.jsx("div",{className:"text-6xl mb-4",children:f}),t.jsx("h2",{className:"text-3xl font-bold",children:m}),t.jsx("p",{className:"text-xl",children:c?"You've mastered the game! \uD83C\uDF89":"Don't give up, keep practicing! \uD83D\uDCAA"}),t.jsx("div",{className:"flex flex-col space-y-4",children:t.jsx(z,{onClick:l,variant:"outline",size:"lg",children:"Return to Lobby \uD83C\uDFE0"})})]})})}function Ue({roomNumber:c,onCancel:l}){const[f,m]=S.useState("");return S.useEffect(()=>{const b=setInterval(()=>{m(M=>M.length<3?M+".":"")},500);return()=>clearInterval(b)},[]),t.jsx("div",{className:"flex flex-col items-center justify-center bg-gray-100",children:t.jsxs(E.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5},className:"bg-white rounded-lg shadow-lg p-8 min-w-md w-full space-y-6 text-center",children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Waiting for Player to Join"}),t.jsxs("p",{className:"text-lg text-gray-600",children:["Room: ",t.jsx("span",{className:"font-semibold",children:c})]}),t.jsxs("div",{className:"flex justify-center space-x-4",children:[t.jsx(E.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},className:"w-16 h-16 rounded-full border-4 border-blue-500 border-t-transparent flex items-center justify-center",children:t.jsx("span",{className:"text-3xl",children:"\uD83C\uDFB2"})}),t.jsx(E.div,{animate:{scale:[1,1.2,1]},transition:{duration:1.5,repeat:1/0},className:"text-4xl",children:"\uD83D\uDC65"})]}),t.jsxs("p",{className:"text-xl text-gray-700 flex items-center justify-center",children:[t.jsx("span",{children:"Waiting for opponent"}),t.jsx(E.span,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:f})]}),t.jsxs("div",{className:"flex justify-center space-x-2",children:[t.jsx(E.div,{animate:{y:[0,-10,0]},transition:{duration:1,repeat:1/0,repeatType:"reverse"},className:"text-2xl",children:"\uD83C\uDFC1"}),t.jsx(E.div,{animate:{y:[0,-10,0]},transition:{duration:1,repeat:1/0,repeatType:"reverse",delay:.3},className:"text-2xl",children:"\uD83C\uDFC1"}),t.jsx(E.div,{animate:{y:[0,-10,0]},transition:{duration:1,repeat:1/0,repeatType:"reverse",delay:.6},className:"text-2xl",children:"\uD83C\uDFC1"})]}),t.jsxs(z,{onClick:()=>{const b=window.location.href;navigator.clipboard.writeText(b).then(()=>{Ne.success("Link copied to clipboard! Share it with your friend.")}).catch(M=>{console.error("Failed to copy: ",M)})},variant:"outline",className:"w-full mb-2",children:[t.jsx(Oe,{className:"mr-2 h-4 w-4"})," Share Game Link"]}),t.jsx(z,{onClick:l,variant:"outline",className:"w-full mt-2",children:"Cancel and Return to Lobby \uD83D\uDEAA"})]})})}function ze(){const[c,l]=S.useState("");return S.useEffect(()=>{const f=setInterval(()=>{l(m=>m.length<3?m+".":"")},500);return()=>clearInterval(f)},[]),t.jsxs("div",{className:"mb-6 flex flex-col items-center justify-center bg-gray-100",children:[t.jsxs("div",{className:"text-2xl font-bold text-gray-700 flex items-center",children:[t.jsx("span",{className:"mr-2",children:"Your turn"}),t.jsx(E.span,{initial:{scale:0},animate:{scale:1},transition:{duration:.5},children:"\uD83E\uDD14"}),t.jsx("span",{children:c})]}),t.jsxs("div",{className:"mt-4 flex items-center space-x-4",children:[t.jsx(E.div,{className:"w-12 h-12 rounded-full bg-green-500 flex items-center justify-center",animate:{y:[0,-10,0]},transition:{duration:1,repeat:1/0},children:t.jsx("span",{className:"text-2xl",children:"♟️"})}),t.jsx(E.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.5},className:"text-3xl",children:"\uD83D\uDC49"})]})]})}function Ve(){const[c,l]=S.useState("");return S.useEffect(()=>{const f=setInterval(()=>{l(m=>m.length<3?m+".":"")},500);return()=>clearInterval(f)},[]),t.jsxs("div",{className:"mb-6 flex flex-col items-center justify-center bg-gray-100",children:[t.jsxs("div",{className:"text-2xl font-bold text-gray-700 flex items-center",children:[t.jsx("span",{className:"mr-2",children:"Opponent's turn"}),t.jsx(E.span,{initial:{scale:0},animate:{scale:1},transition:{duration:.5},children:"⏳"}),t.jsx("span",{children:c})]}),t.jsxs("div",{className:"mt-4 flex items-center space-x-4",children:[t.jsx(E.div,{className:"w-12 h-12 rounded-full border-4 border-red-500 border-t-transparent flex items-center justify-center",animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},children:t.jsx("span",{className:"text-2xl",children:"\uD83E\uDD16"})}),t.jsx(E.div,{animate:{x:[0,10,0]},transition:{duration:1,repeat:1/0},className:"text-3xl",children:"\uD83E\uDD14"})]})]})}function $e({winner:c,loser:l,onReturnToLobby:f}){const m=b=>`${b.slice(0,6)}...${b.slice(-4)}`;return t.jsx("div",{className:"flex flex-col items-center justify-center bg-gray-100",children:t.jsxs(E.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5},className:"bg-white rounded-lg shadow-lg p-8 max-w-md min-w-[400px] w-full space-y-6 text-center",children:[t.jsx("h2",{className:"text-3xl font-bold text-gray-800",children:"Game Result \uD83C\uDFC1"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"bg-yellow-100 p-4 rounded-lg",children:[t.jsxs("h3",{className:"text-xl font-semibold text-yellow-800 flex items-center justify-center",children:[t.jsx(Le,{className:"mr-2"})," Winner"]}),t.jsx("p",{className:"text-lg text-yellow-700",children:m(c)}),t.jsx("p",{className:"text-2xl font-bold text-yellow-800",children:"\uD83C\uDFC6"})]}),t.jsxs("div",{className:"bg-gray-100 p-4 rounded-lg",children:[t.jsxs("h3",{className:"text-xl font-semibold text-gray-700 flex items-center justify-center",children:[t.jsx(Se,{className:"mr-2"})," Loser"]}),t.jsx("p",{className:"text-lg text-gray-600",children:m(l)}),t.jsx("p",{className:"text-2xl font-bold text-gray-700",children:"\uD83D\uDE22"})]})]}),t.jsx(E.div,{animate:{scale:[1,1.1,1]},transition:{duration:2,repeat:1/0},className:"text-6xl",children:"\uD83C\uDFAD"}),t.jsxs(z,{onClick:f,className:"w-full",children:[t.jsx(Te,{className:"mr-2 h-4 w-4"})," Return to Lobby \uD83C\uDFE0"]})]})})}Je=function(){const c=Ee(),{address:l,account:f}=Ce(),[m,b]=S.useState({board:["GREEN",null,"ORANGE","ORANGE","GREEN"],currentPlayer:"GREEN",winner:null,selectedPiece:null,lastMove:"",creator:""}),[M,R]=S.useState({}),P=Ie(),{client:D,db:G}=ke(),{waitForTransaction:U}=Pe(),[B,Y]=S.useState(0);console.log(G,m,l,"state");const H=x=>{console.log(x,"game");const y=[];x.grids.forEach(I=>{I.occupied?y[I.name]=I.player===x.creator?"GREEN":"ORANGE":y[I.name]=null});const N=[...new Set(x.grids.filter(I=>I.occupied).map(I=>I.player))],C=N.reduce((I,q)=>({...I,[q]:q===x.creator?"GREEN":"ORANGE"}),{}),_=N.reduce((I,q)=>{const ee=q===x.creator?"GREEN":"ORANGE";return I[ee]=q,I},{});R(_),console.log(N,"players");const K=N.find(I=>I!==x.last_move_player);b({...m,board:y,currentPlayer:C[K],lastMove:x.last_move_player,winner:x.status===2?x.winner:null,creator:x.creator}),Y(x.status)},J=async()=>{const x=new de().namespace("dojo_starter",y=>y.entity("Container",N=>N.eq("game_id",c.id))).build();try{await G?.getEntities({query:x,callback:y=>{if(y.error){console.error("resp.error.message:",y.error.message);return}if(y.data){console.log(y.data,"res");const N=y.data?.find(C=>C.models.dojo_starter?.Container.game_id===Number(c.id));N&&H(N.models.dojo_starter.Container),console.log(N,"current")}}})}catch(y){console.error("Error querying entities:",y)}};S.useEffect(()=>{J()},[]),S.useEffect(()=>{let x;return(async()=>{const N=await G?.subscribeEntityQuery({query:new de().namespace("dojo_starter",C=>C.entity("Container",_=>_.eq("game_id",c.id))).build(),callback:C=>{if(console.log(C),C.error)console.error("Error setting up entity sync:",C.error);else if(C.data&&C.data[0].entityId!=="0x0"){console.log("subscribed",C);const _=C.data[0].models?.dojo_starter?.Container;_&&H(_)}}});x=()=>N?.cancel()})(),()=>{x&&x()}},[G,l,c.id]);const Q=async(x,y)=>{const N=parseInt(c.id,16),C=await D.actions.move(f,x,y,N);await U(C?.transaction_hash)},p=({player:x,color:y})=>t.jsxs("div",{className:`flex items-center space-x-2 p-2 rounded-full ${y} text-white`,children:[t.jsx("span",{className:"font-medium",children:Re(x)}),x===l&&t.jsx("span",{className:"bg-white text-black text-xs px-2 py-1 rounded-full",children:"YOU"})]}),X=async()=>{const x=parseInt(c.id,16),y=await D.actions.joiningGame(f,x);if(console.log(y,"tx"),!y)return;const N=await U(y?.transaction_hash);console.log(N)},Z=l===M.GREEN||l===M.ORANGE,$=B===1&&Z;return console.log(Z,"isPlayer"),t.jsx("div",{className:"bg-gray-100 h-full",children:t.jsxs("div",{className:"flex flex-col items-center justify-center w-full h-full",children:[t.jsxs("div",{children:[B===0?m.creator!==l?t.jsx(qe,{inviterAddress:m.creator,onAcceptInvitation:X,onDeclineInvitation:()=>P("/")}):t.jsx(Ue,{roomNumber:c.id,onCancel:()=>P("/")}):null,$?m.lastMove!==l?t.jsx(ze,{}):t.jsx(Ve,{}):null,B===2?l===M.GREEN||l===M.ORANGE?t.jsx(We,{isWinner:m.winner===l,onReturnToLobby:()=>{P("/")}}):t.jsx($e,{winner:m.winner,loser:m.winner===M.GREEN?M.ORANGE:M.GREEN,onReturnToLobby:()=>P("/")}):null]}),B===1&&t.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg relative pt-10",children:[t.jsx(_e,{board:m.board,currentPlayer:m.currentPlayer,selectedPiece:m.selectedPiece,onSelect:x=>b(y=>({...y,selectedPiece:x})),onMove:Q}),t.jsxs("div",{className:"flex justify-between my-6",children:[t.jsx(p,{player:M.GREEN,color:"bg-green-500"}),t.jsx(p,{player:M.ORANGE,color:"bg-yellow-500"})]}),t.jsx("div",{className:"text-center",children:t.jsxs("p",{className:"text-xl",children:["Current Player: ",m.currentPlayer==="GREEN"?"Green":"Orange"]})})]})]})})}});export{Je as default,__tla};